<button
  id="theme-toggle"
  class="inline-flex items-center p-0 bg-transparent border-0 transition-colors text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-100"
  aria-label="Toggle theme"
  transition:persist
>
  <span class="sr-only">Toggle theme</span>
    <!-- Material Symbols icons -->
  <span id="sun" class="material-symbols-rounded hidden dark:block" style="font-size:16px">light_mode</span>
  <span id="moon" class="material-symbols-rounded dark:hidden" style="font-size:16px">dark_mode</span>

</button>

<script>
  function attachThemeToggle() {
    const button = document.getElementById("theme-toggle");
    if (!button) return;
    if (button instanceof HTMLElement && button.dataset.bound === "1") return;

    button.addEventListener("click", () => {
      const isDark = document.documentElement.classList.toggle("dark");
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });
    if (button instanceof HTMLElement) button.dataset.bound = "1";
  }

  // 初始化和页面切换时都重新绑定
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", attachThemeToggle, {
      once: true,
    });
  } else {
    attachThemeToggle();
  }
  document.addEventListener("astro:page-load", attachThemeToggle);
</script>
